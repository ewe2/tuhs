From: clefevre-lists@noos.fr (Cyrille Lefevre)
Date: 19 Apr 2001 05:30:48 +0200
Subject: [pups] 2.11BSD system
In-Reply-To: <0104170114250J.00508@klamath.leguin.org.uk>
References: <0104170114250J.00508@klamath.leguin.org.uk>
Message-ID: <bspto9av.fsf@gits.dyndns.org>

Edward Brocklesby <ejb at leguin.org.uk> writes:

> The public access 2.11BSD system is finally back up, at styx.leguin.org.uk.  
> You might find your account has been deleted, in which case just create a new 
> one..

works well :)

please, could you open access to /usr/src since many files are 640 ?

something like chmod -R o+r /usr/src and maybe
find /usr/src -type d -print | xargs chmod o+x

thanks in advance.

Cyrille.
--
home: mailto:clefevre at poboxes.com   UNIX is user-friendly; it's just particular
work: mailto:Cyrille.Lefevre at edf.fr   about who it chooses to be friends with.

Received: (from major at localhost)
	by minnie.cs.adfa.edu.au (8.9.3/8.9.3) id QAA50563
	for pups-liszt; Thu, 19 Apr 2001 16:07:32 +1000 (EST)
	(envelope-from owner-pups at minnie.cs.adfa.edu.au)
Received: from klamath.leguin.org.uk (pc62-oxf1.cable.ntl.com [62.254.132.62])
	by minnie.cs.adfa.edu.au (8.9.3/8.9.3) with ESMTP id QAA50559
	for <pups at minnie.cs.adfa.edu.au>; Thu, 19 Apr 2001 16:07:28 +1000 (EST)
	(envelope-from ejb at leguin.org.uk)
Received: from klamath.leguin.org.uk (klamath [127.0.0.1])
	by klamath.leguin.org.uk (8.9.3/8.9.3/Debian 8.9.3-21) with SMTP id GAA08869;
	Thu, 19 Apr 2001 06:58:50 +0100
X-Authentication-Warning: klamath.leguin.org.uk: Host klamath [127.0.0.1] claimed to be klamath.leguin.org.uk
Content-Type: text/plain;
  charset="iso-8859-1"
From: Edward Brocklesby <ejb@leguin.org.uk>
Organization: Leguin Network Services
To: Cyrille Lefevre <clefevre at poboxes.com>,
        Cyrille Lefevre <clefevre-lists at noos.fr>
Subject: Re: [pups] 2.11BSD system
Date: Thu, 19 Apr 2001 06:58:49 +0100
X-Mailer: KMail [version 1.2]
Cc: pups at minnie.cs.adfa.edu.au
References: <0104170114250J.00508 at klamath.leguin.org.uk> <bspto9av.fsf at gits.dyndns.org>
In-Reply-To: <bspto9av.fsf at gits.dyndns.org>
MIME-Version: 1.0
Message-Id: <01041906584901.00527 at klamath.leguin.org.uk>
Content-Transfer-Encoding: 8bit
Sender: owner-pups at minnie.cs.adfa.edu.au
Precedence: bulk

On Thursday 19 April 2001  4:30 am, Cyrille Lefevre wrote:
> please, could you open access to /usr/src since many files are 640 ?

well.. i can't do that without violating SCO's license.  however, i am 
working on a program to add people to the src group once they have indicated 
they agree to the license.

	-larne-

Received: (from major at localhost)
	by minnie.cs.adfa.edu.au (8.9.3/8.9.3) id WAA52655
	for pups-liszt; Thu, 19 Apr 2001 22:06:22 +1000 (EST)
	(envelope-from owner-pups at minnie.cs.adfa.edu.au)
Received: from mail.noos.fr (descartes.noos.net [212.198.2.74])
	by minnie.cs.adfa.edu.au (8.9.3/8.9.3) with ESMTP id WAA52651
	for <pups at minnie.cs.adfa.edu.au>; Thu, 19 Apr 2001 22:06:18 +1000 (EST)
	(envelope-from root at gits.dyndns.org)
Received: (qmail 10441927 invoked by uid 0); 19 Apr 2001 11:57:47 -0000
Received: from d165.dhcp212-198-231.noos.fr (HELO gits.dyndns.org) ([212.198.231.165]) (envelope-sender <root at gits.dyndns.org>)
          by descartes.noos.net (qmail-ldap-1.03) with DES-CBC3-SHA encrypted SMTP
          for <pups at minnie.cs.adfa.edu.au>; 19 Apr 2001 11:57:47 -0000
Received: (from root at localhost)
	by gits.dyndns.org (8.11.3/8.11.3) id f3JBvgq85414;
	Thu, 19 Apr 2001 13:57:42 +0200 (CEST)
	(envelope-from root)
From: Cyrille Lefevre <root@gits.dyndns.org>
Message-Id: <200104191157.f3JBvgq85414 at gits.dyndns.org>
Subject: Re: [pups] 2.11BSD system
In-Reply-To: <01041906584901.00527 at klamath.leguin.org.uk> "from Edward Brocklesby
 at Apr 19, 2001 06:58:49 am"
To: Edward Brocklesby <ejb at leguin.org.uk>
Date: Thu, 19 Apr 2001 13:57:42 +0200 (CEST)
CC: pups at minnie.cs.adfa.edu.au
Reply-To: clefevre at poboxes.com
Organization: ACME
X-Face: V|+c;4!|B?E%BE^{E6);aI.[<<r#uCVjK"~Ke!@0vxS/.,wki/c|uVnNV!BA-_gY2sfoGc3
	f{#/$PT>97Zd*>^#%Y5Cxv;%Y[PT-LW3;A:fRrJ8+^k"e7 at +30g0YD0*^^3jgyShN7o?a]C
	la*Zv'5NA,=963bM%J^o]C
X-Mailer: ELM [version 2.4ME+ PL88 (25)]
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset=US-ASCII
Sender: owner-pups at minnie.cs.adfa.edu.au
Precedence: bulk

Edward Brocklesby wrote:
> On Thursday 19 April 2001  4:30 am, Cyrille Lefevre wrote:
> > please, could you open access to /usr/src since many files are 640 ?
> 
> well.. i can't do that without violating SCO's license.  however, i am 
> working on a program to add people to the src group once they have indicated 
> they agree to the license.

oh! I see. forgot about that.

see you.

Cyrille.
--
home: mailto:clefevre at poboxes.com   UNIX is user-friendly; it's just particular
work: mailto:Cyrille.Lefevre at edf.fr   about who it chooses to be friends with. 

Received: (from major at localhost)
	by minnie.cs.adfa.edu.au (8.9.3/8.9.3) id AAA53529
	for pups-liszt; Fri, 20 Apr 2001 00:42:00 +1000 (EST)
	(envelope-from owner-pups at minnie.cs.adfa.edu.au)
Received: from nose.cs.utoronto.ca (nose.cs.utoronto.ca [128.100.27.218])
	by minnie.cs.adfa.edu.au (8.9.3/8.9.3) with SMTP id AAA53525
	for <pups at minnie.cs.adfa.edu.au>; Fri, 20 Apr 2001 00:41:54 +1000 (EST)
	(envelope-from norman at nose.cs.utoronto.ca)
Message-Id: <200104191441.AAA53525 at minnie.cs.adfa.edu.au>
Subject: [pups] Sigma RQD11s, ESDI, and other naughty words
From: norman@nose.cs.utoronto.ca (Norman Wilson)
To: pups at minnie.cs.adfa.edu.au
Date: Thu, 19 Apr 2001 10:32:52 -0400
Sender: owner-pups at minnie.cs.adfa.edu.au
Precedence: bulk

A couple of weeks ago, I asked if anyone had any suggestions to help
me convince a Sigma RQD11 Qbus-to-ESDI controller that it had disks
attached.  The trouble turned out to be pretty silly--the A-cable
terminator in the disk I was testing with was in backwards--but later
I discovered what may be a genuine controller botch that is worth
reporting.

Like most Qbus disk controllers, the RQD11 speaks the MSCP protocol
to the host.  More precisely it understands MSCP messages and uses
UQSSP to transmit them; UQSSP is the transport protocol used by
UNIBUS and Qbus controllers like the UDA50 and KDA50 and RQDX3 and
TQK50 and so on.  In general, the host sends commands like `bring
drive online' or `read a block' to the controller, and the controller
sends back response messages like `command succeeded' or `command failed.'
(Never mind how the data part of the block is sent to memory for now.)

The host sets up a ring of buffers for the controller to place messages
in.  Each buffer has an ownership flag: messages owned by the controller
are available to hold new messages; messages owned by the host are not,
usually because there's already a message there.  When the controller
has a message to send, it waits (if necessary) until it owns the next
buffer in the ring (the ring is used in strict round-robin order);
puts the message there; and sets the ownership flag to `host.'
When the host has handled the message, or at least copied it elsewhere,
it sets the flag back to `controller.'

When the controller gives a message to host, it also generates an
interrupt.  There are several other reasons for generating an interrupt,
so it is also supposed to set a single flag elsewhere in a communication
area in host memory to mean `there are new messages.'

My UQSSP driver code checked for new messages only if the flag was set,
and that caused me grief; it turns out that, at least when the host is
a MicroVAX III, the RQD11 sets the `new messages' flag inconsistently,
or perhaps too late.  Presumably it should have been set before requesting
the interrupt, but empirically I can see that sometimes it gets set later.
The effect was that the controller did what I told it, but my device driver
never heard the acknowledgement that said it did.  Obviously this makes
I/O unreasonably slow.

Fortunately there's a simple way around this: my driver's interrupt routine
now peeks at the ownership flag for the buffer where the next message
should appear.  (Remember that the message buffers are used in strict order,
so the host always knows exactly which buffer that is.)  When I do that,
all is well.

I suspect that many existing UQSSP drivers already did what my code does
now; in particular, the controllers and disks I am testing are known to
have worked for many years with Ultrix, and while searching for data on
the controller I came across various notes suggesting that the RQD11 works
under NetBSD/VAX as well.  But those who are writing new code or making
changes to existing code should beware; the RQD11 appears to be breaking
the rules (according to the old UQSSP manual I still have), and (as in
many real-world protocol situations) if you write your code from the spec
(as I did, in fact, albeit many years ago), the real world may trip it up.

Norman Wilson



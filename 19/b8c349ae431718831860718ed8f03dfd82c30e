X-Spam-Checker-Version: SpamAssassin 3.4.4 (2020-01-24) on inbox.vuxu.org
X-Spam-Level: 
X-Spam-Status: No, score=-0.8 required=5.0 tests=DKIM_INVALID,DKIM_SIGNED,
	MAILING_LIST_MULTI,T_SCC_BODY_TEXT_LINE autolearn=ham
	autolearn_force=no version=3.4.4
Received: (qmail 9343 invoked from network); 16 Jul 2022 09:32:09 -0000
Received: from minnie.tuhs.org (50.116.15.146)
  by inbox.vuxu.org with ESMTPUTF8; 16 Jul 2022 09:32:09 -0000
Received: from minnie.tuhs.org (localhost [IPv6:::1])
	by minnie.tuhs.org (Postfix) with ESMTP id 45B8D406E4;
	Sat, 16 Jul 2022 19:32:02 +1000 (AEST)
Received: from ewsoutbound.kpnmail.nl (ewsoutbound.kpnmail.nl [195.121.94.168])
	by minnie.tuhs.org (Postfix) with ESMTPS id E25534068E
	for <tuhs@tuhs.org>; Sat, 16 Jul 2022 19:31:50 +1000 (AEST)
X-KPN-MessageId: 09c355a6-04ea-11ed-a80d-005056aba152
Received: from smtp.kpnmail.nl (unknown [10.31.155.37])
	by ewsoutbound.so.kpn.org (Halon) with ESMTPS
	id 09c355a6-04ea-11ed-a80d-005056aba152;
	Sat, 16 Jul 2022 11:31:15 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=planet.nl; s=planet01;
	h=to:message-id:date:from:subject:mime-version:content-type;
	bh=gV6Zdc4jjTiNDfCQZx9FWVjONDyJVAubCCnrB8rBrWU=;
	b=A+imNM+771lVqTKzaWHDj2Rpoez2QBtQL1+mCL9OkfwVzaVAVbrQ54W9NpiyjMcdvODWQINXXLX/I
	 QXX29tHAtt5KauXbuwvBH0FvvhucDyHiRwnvZQkfuzKzZcBjB1gYvfPR5E6awDHSjYnGnQD/8T/cQJ
	 WPF0YlA6AgKcuxrE=
X-KPN-MID: 33|+BuAt4t6K/4EhPv2101Rmj8ZLa0J32UTciSHmL3/G0Xl7VKQHE1hMvi4afaMYaX
 AJUWz2jol/2Vl85dNvauU+gkylLswd9fjDFB63zK6Mk4=
X-KPN-VerifiedSender: Yes
X-CMASSUN: 33|txJivdF1RZxGRpJiYA8Kf9+SJAXisSQbQJnpBLfqWk9Q1gk8uPI4i24JXQdVmc5
 WUDFlJcDClR2GgJJytW5Kvg==
X-Originating-IP: 77.172.38.96
Received: from smtpclient.apple (77-172-38-96.fixed.kpn.net [77.172.38.96])
	by smtp.kpnmail.nl (Halon) with ESMTPSA
	id 15553298-04ea-11ed-929b-005056ab1411;
	Sat, 16 Jul 2022 11:31:35 +0200 (CEST)
Content-Type: text/plain;
	charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 14.0 \(3654.120.0.1.13\))
From: Paul Ruizendaal <pnr@planet.nl>
In-Reply-To: <2hK72A6Itq5yUS4eqzueKuU8hSC1JCR3XQbiHWTXnp-VS1V-eItyJ1gscCj2QR-0knXF7ukWVBxxzrC6e4TaN86l_2WAYK1eGrae2cskPb4=@protonmail.com>
Date: Sat, 16 Jul 2022 11:31:34 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <E588CCC9-D1C6-48B5-B4F3-13CEAC4F96F1@planet.nl>
References: <2hK72A6Itq5yUS4eqzueKuU8hSC1JCR3XQbiHWTXnp-VS1V-eItyJ1gscCj2QR-0knXF7ukWVBxxzrC6e4TaN86l_2WAYK1eGrae2cskPb4=@protonmail.com>
To: segaloco <segaloco@protonmail.com>
X-Mailer: Apple Mail (2.3654.120.0.1.13)
Message-ID-Hash: DG4MGSNOIMLRRAYYMBYY5WHQHX6YFQYO
X-Message-ID-Hash: DG4MGSNOIMLRRAYYMBYY5WHQHX6YFQYO
X-MailFrom: pnr@planet.nl
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation; header-match-tuhs.tuhs.org-0; nonmember-moderation; administrivia; implicit-dest; max-recipients; max-size; news-moderation; no-subject; digests; suspicious-header
CC: The Eunuchs Hysterical Society <tuhs@tuhs.org>
X-Mailman-Version: 3.3.6b1
Precedence: list
Subject: [TUHS] Re: V8 4BSD or 32V Based? (was: Unix V8 Chaosnet, any takers?)
List-Id: The Unix Heritage Society mailing list <tuhs.tuhs.org>
Archived-At: <https://www.tuhs.org/mailman3/hyperkitty/list/tuhs@tuhs.org/message/DG4MGSNOIMLRRAYYMBYY5WHQHX6YFQYO/>
List-Archive: <https://www.tuhs.org/mailman3/hyperkitty/list/tuhs@tuhs.org/>
List-Help: <mailto:tuhs-request@tuhs.org?subject=help>
List-Owner: <mailto:tuhs-owner@tuhs.org>
List-Post: <mailto:tuhs@tuhs.org>
List-Subscribe: <mailto:tuhs-join@tuhs.org>
List-Unsubscribe: <mailto:tuhs-leave@tuhs.org>



> On 15 Jul 2022, at 19:15, segaloco <segaloco@protonmail.com> wrote:

> Not trying to be combative by any means, but I've been doing a bit of =
research lately into when V8 was snapped from BSD and where Bell and =
Berkeley then diverged from that last major confluence, especially with =
a focus on init and other early stages of userland.

Not taken as combative - always working on the basis of my 'current =
understanding=E2=80=99 and that is evolving continuously as new views =
and facts present themselves.

My comments were intended around the kernel code, not the userland. That =
said, I=E2=80=99ve looked into this a bit more and I think you were more =
right than I was.

> "Research Unix 8th Edition started from (I think) BSD 4.1c, but with =
enormous amounts scooped out and replaced by our own stuff." - Dennis =
Ritchie

That is a good quote, but I think there is a better way to look at this, =
which is Warren=E2=80=99s tool to establish similarity between files (it =
is integrated with the Unix Tree webpage on TUHS).

> There's definitely a good chunk of code from 4BSD.  Compare init, =
getty, locore.c (as opposed to .s in V7 back).  Heck, even the main.c =
between the two kernels are more similar to each other than V7.  I would =
almost opt towards calling that being rebased on 4BSD rather than V7 =
with bits and pieces of BSD added.  I could see it being more beneficial =
to start with 4BSD and tack on necessary Bell bits rather than take =
V7/32V and try and shoehorn in the VM implementation for VAX.

Looking at various kernel files in the V8 tree, it would seem that the =
most comparable file in the TUHS database (and excluding V9-V10) would =
typically be =E2=80=9CBBN-TCP=E2=80=9D, closely followed by =E2=80=9C4BSD=E2=
=80=9D. This BBN-TCP kernel code is based on a snapshot of BSD from =
August 1980 (see its history file). Joy sent it to Gurwitz for =
integration of the BBN TCP stack with the BSD kernel. I think it is (or =
is close to) 4.1BSD.

=46rom the output of Warren=E2=80=99s tool, it also seems that 4.1c =
deviated/evolved considerably from that base. It would require a more =
in-depth comparison to say more, but based on this quick check I think =
it is reasonable to say that V8 started from 4.1BSD (and not 32V as I =
thought, or 4.1c as dmr remembered). It would be interesting to see what =
the "enormous amounts scooped out=E2=80=9D exactly were -- but maybe =
this refers more to the userland than the kernel.

Some bits - like select() - were not in 4.1BSD and would have come from =
4.1c. The V8 kernel still has a lowcore.s (next to lowcore.c). =
Interestingly, this has the best match with later BSD versions. In all =
likelihood, there was cross-fertilisation after the initial code fork.

> The 4.1cBSD copy on the archive does appear to be pretty different, so =
in terms of raw comparison, I suspect the basis is 4BSD rather than =
4.1cBSD.  I don't know that we have a clean copy of 4.1BSD gold, I'd be =
interested to see if the structure of the source code changed between =
4.1 and 4.1c, as 4.1c does exhibit the new organization by the BSD =
folks, 4BSD still shows folders like cmd, lib, and so on.

Yes, we have (now) reached the same conclusion, but don=E2=80=99t forget =
that V8 adds a lot of innovation on top of that (streams, file system =
switch, virtual proc file system, networking, remote file system, =
support for the Blit terminal, etc.). Networking in the V8 kernel =
(including Chaos) is organised very differently from 4.1cBSD.

Paul

